<!DOCTYPE html>
<html class="no-js" lang="en-us"><head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="Just a blog">
 <meta name="author" content="SecuGram">
<meta name="generator" content="Hugo 0.82.0">

<title>SecuGram</title>

<!-- Mobile Specific Meta -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Favicon -->
<link rel="shortcut icon" type="image/x-icon" href="https://www.falconforce.nl/images/favicon.ico">

<!-- Stylesheets -->
<!-- bootstrap.min css -->
<link rel="stylesheet" href="https://www.falconforce.nl/plugins/bootstrap/dist/css/bootstrap.min.css">
<!-- Main Stylesheet -->


<link rel="stylesheet" href="https://www.falconforce.nl/css/style.min.css" integrity media="screen">

</head>
<body id="body">
        <!-- Start Preloader -->
<div id="preloader">
    <div class="preloader">
        <div class="sk-circle1 sk-child"></div>
        <div class="sk-circle2 sk-child"></div>
        <div class="sk-circle3 sk-child"></div>
        <div class="sk-circle4 sk-child"></div>
        <div class="sk-circle5 sk-child"></div>
        <div class="sk-circle6 sk-child"></div>
        <div class="sk-circle7 sk-child"></div>
        <div class="sk-circle8 sk-child"></div>
        <div class="sk-circle9 sk-child"></div>
        <div class="sk-circle10 sk-child"></div>
        <div class="sk-circle11 sk-child"></div>
        <div class="sk-circle12 sk-child"></div>
    </div>
</div>
<!-- End Preloader --><!-- Fixed Navigation -->


<section class="header navigation">

    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <nav class="navbar navbar-expand-md">
                    <a class="navbar-brand" href="https://www.falconforce.nl/">
                        <img src="https://www.falconforce.nl/images/logo.png" alt="logo">
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="tf-ion-android-menu"></span>
                    </button>
                    
                    <div id="drapeaux">
                        
                        
                    </div>
                    <div class="collapse navbar-collapse" id="navigation">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="https://www.falconforce.nl/">Home</a>
                            </li>
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="../../about/">About</a>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="../../service/">Services</a>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="../../jobs/">Jobs</a>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="../">Blog</a>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="../../training/">Training</a>
                            </li>
                            
                            
                            
                            <li class="nav-item">
                                <a class="nav-link" href="../../contact/">Contact</a>
                            </li>
                            
                            
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</section>
<div id="content">

<section class="blog-single section">
    <div class="container">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <img src="https://www.falconforce.nl/images/blog/internal.jpg" class="w-100 mb-3" alt="Post-Image">
                <h2>The curious case of Realtek and LSASS</h2>
                <div class="post-meta mb-5">
                    <ul class="list-inline">
                        <li class="list-inline-item">
                            <span>By</span>
                            Henri Hambartsumyan
                        </li>
                        <li class="list-inline-item">
                            <span>at</span>
                            <span>October 2, 2020</span>
                        </li>
                    </ul>
                </div>
                <p>Introduction</p>
<p>I was working on building some new hunts in Microsoft Defender ATP (MDATP). After spending a whole day writing KQL, I was almost done with it. I spent the day building new hunts to detect malicious code executions and wanted to fine-tune the last rule of the day to get rid of the false positives as much as possible. This rule was meant to detect malicious DLL injections (will publish the rule once it‚Äôs ready to share). I was going through the ‚Äò*ApiCall‚Äô actions in ‚ÄòDeviceEvents‚Äô when I noticed that RtkAuduservice64.exe was calling ‚ÄòOpenProcess‚Äô and ‚ÄòReadProcessMemory‚Äô on lsass.exe. To top it off, it‚Äôs doing OpenProcess with ‚ÄòPROCESS_ALL_ACCESS‚Äô. A quick Google revealed that this process is the ‚ÄúRealtek HD Audio Universal Service‚Äù and this is confirmed by the description in the file and the signature on the binary.</p>
<p>Wait‚Ä¶why is a sound driver service thingy reading LSASS 135 times in 7 days??</p>
<p>TL;DR for general readers: RtkAuduservice64.exe might trigger your AV or EDR because of some weird quirks in the implementation of this process. It‚Äôs most likely a false positive. Don‚Äôt freak out immediately.</p>
<p>TL;DR for blue teams: RtkAuduservice64.exe is reading lsass.exe memory ‚Äúby accident‚Äù. This makes it the ideal hiding spot for an attacker to dump creds from memory and blend in. üò±</p>
<p>TL;DR for red teams: RtkAuduservice64.exe is reading lsass.exe memory ‚Äúby accident‚Äù. Inject yourself into this process, dump memory and you won‚Äôt stand out for reading lsass memory. üòà</p>
<p>Cross post from medium.com, please read the full article here:</p>
<p><a href="https://medium.com/SecuGram/the-curious-case-of-realtek-and-lsass-33fc0c8482ff">https://medium.com/SecuGram/the-curious-case-of-realtek-and-lsass-33fc0c8482ff</a></p>

            </div>
        </div>
    </div>
</section>


        </div><!-- Footer Start -->
<footer id="footer" class="bg-one">
    <div class="top-footer">
        <div class="container">
            <div class="row">
                <div class="col-sm-3 offset-sm-3">
                    <h3>Who we are</h3>
                    <ul>
                        
                        <li>
                            <a href="../../about/">About us</a>
                        </li>
                        
                    </ul>
                </div>
                <div class="col-sm-3">
                    <h3>What we do</h3>
                    <ul>
                        
                        <li>
                            <a href="../../service/">About services</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <h5>Copyright 2020-2021. All rights reserved.</h5>
        <h6>SecuGram B.V. KVK 76682307</h6>
    </div>
</footer>
<!-- end footer -->


<!-- Essential Scripts -->

<!-- jQuery -->
<script src="https://www.falconforce.nl/plugins/jquery/dist/jquery.min.js"></script>
<!-- Themefisher Icon font -->
<link rel="stylesheet" href="https://www.falconforce.nl/plugins/themefisher-font/style.css">
<script src="https://www.falconforce.nl/plugins/bootstrap/dist/js/popper.min.js"></script>
<script src="https://www.falconforce.nl/plugins/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- Main Script -->

<script src="https://www.falconforce.nl/js/script.min.js"></script>
</body>
</html>
